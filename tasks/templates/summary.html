{% extends 'base.html' %}
{% load render_assets %}

{% block title %}Summaries | Tasks Collector{% endblock %}

{% block content %}
<!-- Vue entry-point -->

<div class="summaries">
    {% include "menu.html" %}

    {% if not single_view %}
    <div class="date-filters" style="margin-bottom: 20px;">
        <form method="get" action="{% url 'summaries' %}" style="display: flex; gap: 10px; align-items: center;">
            <label for="from">From:</label>
            <input type="date" id="from" name="from" value="{{ request.GET.from }}" onchange="this.form.submit()">

            <label for="to">To:</label>
            <input type="date" id="to" name="to" value="{{ request.GET.to }}" onchange="this.form.submit()">

            {% if request.GET.from or request.GET.to %}
            <a href="{% url 'summaries' %}" style="margin-left: 10px;">Reset</a>
            {% endif %}
        </form>
    </div>
    {% endif %}

    {% for summary in summaries %}

    <article class="summary">
        <h2>
            {% if not single_view %}
            <a href="{% url 'board-summary' summary.board.id %}">
                {{ summary.board.date_closed|date }} ({{ summary.board.thread }}):
            </a>
            {% else %}
            {{ summary.board.date_closed|date }} ({{ summary.board.thread }}):
            {% endif %}
            <span class="focus">
                {{ summary.board.focus }}


                <small>
                    [{{ summary.board.date_started|date:"Y-m-d" }} â€“
                    {{ summary.board.date_closed|date:"Y-m-d" }},
                    {{ summary.days }} days]
                </small>
            </span>
        </h2>

        <div class="boxes">
            {% if summary.finished_count > 0 %}
            <ol class="finished">
                {% for item in summary.finished %}
                    {% include "item.html" %}
                {% endfor %}
            </ol>
            {% endif %}
    
            {% if summary.postponed_count > 0 %}
            <ol class="postponed">
                {% for item in summary.postponed %}
                    {% include "item.html" %}
                {% endfor %}
            </ol>
            {% endif %}
            {% if summary.removed_count > 0 %}
            <ol class="removed">
                {% for item in summary.removed %}
                    {% include "item.html" %}
                {% endfor %}
            </ol>
            {% endif %}
        </div>
    </article>

    {% endfor %}
</div>

{% endblock %}

